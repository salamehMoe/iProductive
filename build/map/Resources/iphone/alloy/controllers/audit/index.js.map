{"version":3,"sources":["template.js","app/controllers/audit/index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ADMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"/Users/exsalameh/Desktop/iProductive-2/Resources/iphone/alloy/controllers/audit/index.js","sourceRoot":"/Users/exsalameh/Desktop/iProductive-2","sourcesContent":["var Alloy = require('/alloy'),\n\tBackbone = Alloy.Backbone,\n\t_ = Alloy._;\n\n\n\n\nfunction __processArg(obj, key) {\n\tvar arg = null;\n\tif (obj) {\n\t\targ = obj[key] || null;\n\t}\n\treturn arg;\n}\n\nfunction Controller() {\n\t\n\trequire('/alloy/controllers/' + 'BaseController').apply(this, Array.prototype.slice.call(arguments));\n\tthis.__controllerPath = 'audit/index';\n\tthis.args = arguments[0] || {};\n\n\tif (arguments[0]) {\n\t\tvar __parentSymbol = __processArg(arguments[0], '__parentSymbol');\n\t\tvar $model = __processArg(arguments[0], '$model');\n\t\tvar __itemTemplate = __processArg(arguments[0], '__itemTemplate');\n\t}\n\tvar $ = this;\n\tvar exports = {};\n\tvar __defers = {};\n\n\t// Generated code that must be executed before all UI and/or\n\t// controller code. One example is all model and collection\n\t// declarations from markup.\n\tAlloy.Collections.instance('templates');\n\n\t// Generated UI code\n\t$.__views[\"index\"] = (require(\"xp.ui\").createWindow || Ti.UI.createWindow)(\n{backgroundColor:\"#ffffff\",translucent:true,tintColor:Alloy.CFG.tintColor,navTintColor:\"#ffffff\",barColor:Alloy.CFG.borderColor,includeOpaqueBars:true,autoAdjustScrollViewInsets:false,statusBarStyle:Ti.UI.iOS.StatusBar.LIGHT_CONTENT,extendEdges:[Ti.UI.EXTEND_EDGE_TOP,Ti.UI.EXTEND_EDGE_BOTTOM,],id:\"index\",title:\"Audit templates\",}\n);\n$.__views[\"index\"] && $.addTopLevelView($.__views[\"index\"]);\n$.__views[\"__alloyId69\"] = Alloy.createController('centerNavBtns',{id:\"__alloyId69\",__parentSymbol:$.__views[\"index\"],});\n$.__views[\"__alloyId69\"].setParent($.__views[\"index\"]);\nif ((OS_IOS)) {\n$.__views[\"__alloyId70\"] = Ti.UI.createSearchBar(\n{hintText:\"Search ...\",barColor:\"#115EAC\",tintColor:\"#ffffff\",keyboardType:Titanium.UI.RETURNKEY_SEARCH,returnKeyType:Titanium.UI.RETURNKEY_SEARCH,id:\"__alloyId70\",}\n);\n}\nvar __alloyId71={};var __alloyId74=[];var __alloyId75={type:'Ti.UI.Label',bindId:'info',properties:{textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,color:\"black\",left:\"10dp\",top:\"15dp\",bindId:\"info\",},};__alloyId74.push(__alloyId75);var __alloyId76={type:'Ti.UI.Label',bindId:'es_info',properties:{textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,font:{fontSize:\"10dp\",},left:\"10dp\",top:\"40dp\",color:\"black\",bindId:\"es_info\",},};__alloyId74.push(__alloyId76);var __alloyId73 = {properties:{name:\"template\",},childTemplates:__alloyId74,};__alloyId71[\"template\"]=__alloyId73;$.__views[\"headerView\"] = Ti.UI.createView(\n{backgroundColor:\"#efefef\",height:60,id:\"headerView\",}\n);\n$.__views[\"__alloyId80\"] = Ti.UI.createLabel(\n{textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,text:'Welcome, please select a template to be completed',id:\"__alloyId80\",}\n);\n$.__views[\"headerView\"].add($.__views[\"__alloyId80\"]);\n$.__views[\"__alloyId77\"] = Ti.UI.createListSection(\n{headerView:$.__views[\"headerView\"],id:\"__alloyId77\",}\n);\nvar __alloyId84=Alloy.Collections['templates'] || templates;function __alloyId85(e) {   if (e && e.fromAdapter) { return; }   var opts = __alloyId85.opts || {};\tvar models = __alloyId84.models;\tvar len = models.length;var __alloyId78=[];\tfor (var i = 0; i < len; i++) {\t\tvar __alloyId81 = models[i];\t\t__alloyId81.__transform = transformFunction(__alloyId81);var __alloyId83 = {properties:{height:70,accessoryType:Ti.UI.LIST_ACCESSORY_TYPE_DISCLOSURE,AuditID:__alloyId81.__transform.AuditID,title:__alloyId81.__transform.AuditName,CompanyTypeID:__alloyId81.__transform.CompanyTypeID,DeptCode:__alloyId81.__transform.DeptCode,Target:__alloyId81.__transform.Target,searchableText:__alloyId81.__transform.AuditName,type:__alloyId81.__transform.type,},info:{text:__alloyId81.__transform.AuditName,},es_info:{text:__alloyId81.__transform.AuditDesc,},};__alloyId78.push(__alloyId83);\t}opts.animation ? $.__views[\"__alloyId77\"].setItems(__alloyId78, opts.animation) : $.__views[\"__alloyId77\"].items = __alloyId78;};__alloyId84.on('fetch destroy change add remove reset',__alloyId85);var __alloyId86=[];__alloyId86.push($.__views[\"__alloyId77\"]);$.__views[\"list\"] = Ti.UI.createListView(\n{defaultItemTemplate:\"template\",top:62,sections:__alloyId86,templates:__alloyId71,searchView:$.__views[\"__alloyId70\"],id:\"list\",}\n);\n$.__views[\"index\"].add($.__views[\"list\"]);\nstartSurvey?$.addListener($.__views[\"list\"],'itemclick',startSurvey):__defers['$.__views[\"list\"]!itemclick!startSurvey']=true;var __alloyId88 = [];__alloyId88.push(\"OK\");__alloyId88.push(\"Cancel\");$.__views[\"confirmAlert\"] = Ti.UI.createAlertDialog(\n{buttonNames:__alloyId88,title:\"Start audit?\",message:\"Do you want to start this audit now?\",cancel:1,id:\"confirmAlert\",}\n);\nif ((OS_IOS)) {\n$.__views[\"preSurveyView\"] = Alloy.createController('audit/pre_survey',{id:\"preSurveyView\",__parentSymbol:$.__views[\"index\"],});\n$.__views[\"preSurveyView\"].setParent($.__views[\"index\"]);\n}\nexports.destroy = function () {__alloyId84 && __alloyId84.off('fetch destroy change add remove reset',__alloyId85);};\n\n\t// make all IDed elements in $.__views available right on the $ in a\n\t// controller's internal code. Externally the IDed elements will\n\t// be accessed with getView().\n\t_.extend($, $.__views);\n\n\t// Controller code directly from the developer's controller file\n\t__MAPMARKER_CONTROLLER_CODE__\n\n\t// Generated code that must be executed after all UI and\n\t// controller code. One example deferred event handlers whose\n\t// functions are not defined until after the controller code\n\t// is executed.\n\t__defers['$.__views[\"list\"]!itemclick!startSurvey'] && $.addListener($.__views[\"list\"],'itemclick',startSurvey);\n\n\t// Extend the $ instance with all functions and properties\n\t// defined on the exports object.\n\t_.extend($, exports);\n}\n\nmodule.exports = Controller;\n","var pre = Alloy.createController('audit/pre_survey');\nvar startSurvey = function (e) {\n\n  var item = e.section.getItemAt(e.itemIndex);\n\n  //if (!$.confirmAlert.eventAssaignedBefore) {\n  $.confirmAlert.eventAssaignedBefore = true;\n  $.confirmAlert.addEventListener('click', function (alertE) {\n\n    if (alertE.index == 0) {\n\n      if (OS_IOS) {\n\n        $.preSurveyView.show({\n          item: item.properties,\n          onNext: function (formPrams) {\n            //Ti.API.Info('>>> test onNext');\n            Alloy.Globals.pageStack.open(Alloy.createController('audit/sections', {\n              item: item.properties,\n              formPrams: formPrams,\n              isEditing: true }).\n            getView());\n          } });\n\n      } else {\n        pre.titleLbl.setText(\"\");\n        pre.tempName.setValue(\"\");\n        //Ti.API.Info(\"Calling Show: \" + item.title);\n        pre.show({\n          item: item.properties,\n          onNext: function (formPrams) {\n            $.index.remove(pre.getView());\n            Alloy.Globals.pageStack.open(Alloy.createController('audit/sections', {\n              item: item.properties,\n              formPrams: formPrams,\n              isEditing: true }).\n            getView());\n          } });\n\n        $.index.add(pre.getView());\n      }\n    }\n    $.confirmAlert.removeEventListener('click', arguments.callee);\n  });\n  //}\n  $.confirmAlert.show();\n};\n\ntry {\n  Alloy.Collections.templates.fetch({\n    query: \"SELECT * FROM templates WHERE Show > 0 AND deleted = 0\" });\n\n} catch (e) {\n  //Ti.API.Info('error -> '+JSON.stringify(e));\n}\n\nfunction transformFunction(model) {\n\n  m = model.toJSON();\n\n  if (m.AuditDesc == null) {\n    m.AuditDesc = \"\";\n  }\n  return m;\n}\n\n\n\n\n$.index.addEventListener(\"close\", function () {\n  $.destroy();\n});"]}